# IoT Defense System Configuration
# Main configuration for LSTM attack prediction and RL defense training

# Dataset Configuration
dataset:
  name: "CICIoT2023"
  raw_path: "data/raw/CICIoT2023"
  processed_path: "data/processed/ciciot2023"
  sample_size: 500000 # Start with 500K samples for manageable training
  sequence_length: 5 # EDA recommendation
  train_split: 0.7
  val_split: 0.1
  test_split: 0.2
  # Add class balancing strategy
  sampling_strategy: "balanced" # For severe imbalance
  feature_selection: true # Remove low/zero variance features

# LSTM Attack Predictor Configuration
lstm:
  model:
    input_size: 46 # Will be updated dynamically
    hidden_size: 128
    num_layers: 2
    dropout: 0.3 # Increased due to feature selection needs

  training:
    epochs: 20 # EDA recommendation
    batch_size: 32 # EDA recommendation
    learning_rate: 0.001
    weight_decay: 1e-5
    early_stopping_patience: 5 # EDA recommendation
    # Add class imbalance handling from EDA
    use_class_weights: true # For severe imbalance
    focal_loss: true # Better for imbalanced classes
    gradient_accumulation_steps: 1

  data:
    sequence_length: 5 # EDA recommendation
    num_workers: 4 # EDA optimization recommendation
    pin_memory: true

# RL Environment Configuration
environment:
  max_steps: 1000
  attack_probability: 0.3
  state_history_length: 10
  action_history_length: 5
  reward_scale: 1.0

# RL Training Configuration
rl:
  algorithm: "dqn" # Options: dqn, ppo, a2c

  training:
    total_timesteps: 50000 # Reduced for initial training
    eval_freq: 5000
    n_eval_episodes: 10
    save_freq: 12500

  # Algorithm-specific hyperparameters
  algorithms:
    dqn:
      learning_rate: 1e-4
      buffer_size: 50000 # Adjusted for sample size
      learning_starts: 1000
      batch_size: 32
      tau: 1.0
      gamma: 0.99
      train_freq: 4
      gradient_steps: 1
      target_update_interval: 1000
      exploration_fraction: 0.1
      exploration_initial_eps: 1.0
      exploration_final_eps: 0.05
      max_grad_norm: 10

    ppo:
      learning_rate: 3e-4
      n_steps: 2048
      batch_size: 64
      n_epochs: 10
      gamma: 0.99
      gae_lambda: 0.95
      clip_range: 0.2
      clip_range_vf: null
      normalize_advantage: true
      ent_coef: 0.0
      vf_coef: 0.5
      max_grad_norm: 0.5

    a2c:
      learning_rate: 7e-4
      n_steps: 5
      gamma: 0.99
      gae_lambda: 1.0
      ent_coef: 0.0
      vf_coef: 0.5
      max_grad_norm: 0.5
      rms_prop_eps: 1e-5
      use_rms_prop: true
      use_sde: false

# Model Paths
models:
  lstm:
    save_path: "models/lstm/attack_predictor.pth"
    checkpoint_dir: "models/lstm/checkpoints"

  rl:
    save_dir: "models/rl"
    checkpoint_dir: "models/rl/checkpoints"

# Experiment Tracking
mlflow:
  tracking_uri: "mlruns"
  experiment_name: "iot_defense_system"

# Logging Configuration
logging:
  level: "INFO"
  log_dir: "results/logs"

# Results Configuration
results:
  plots_dir: "results/plots"
  reports_dir: "results/reports"
