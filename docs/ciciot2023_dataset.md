# CICIoT2023 Dataset

## Overview

The **CICIoT2023** dataset, developed by the Canadian Institute for Cybersecurity (CIC), is a comprehensive and realistic dataset for research in IoT security. It was created to address the need for up-to-date and diverse datasets that reflect modern IoT network traffic, including a wide array of attack scenarios. This dataset is pivotal to the RL-IoT Defense System, serving as the foundation for training the LSTM attack predictor and informing the dynamics of the simulated IoT environment.

**Official Source:** [University of New Brunswick - CICIoT2023](https://www.unb.ca/cic/datasets/iotdataset-2023.html)

## Dataset Characteristics

-   **Realistic Traffic**: Contains benign IoT traffic and a diverse set of attack traffic generated from a realistic IoT testbed.
-   **Modern Attacks**: Includes a wide variety of contemporary cyberattacks targeting IoT devices and networks.
-   **Extensive Features**: Provides a rich set of network flow features (typically over 80 features from tools like CICFlowMeter) that are crucial for machine learning-based intrusion detection and prediction.
-   **Labeled Data**: Each network flow is labeled as either benign or a specific type of attack, which is essential for supervised learning tasks like training the LSTM attack predictor.

## Attack Categories and Types

The CICIoT2023 dataset includes numerous attack categories, which are further broken down into specific attack types. The main categories often include:

1.  **DDoS (Distributed Denial of Service)**: e.g., TCP, UDP, HTTP Floods
2.  **DoS (Denial of Service)**: e.g., Slowloris, Hulk, GoldenEye
3.  **Reconnaissance**: e.g., Port Scanning, OS Fingerprinting
4.  **Botnet**: Traffic generated by IoT devices compromised and controlled by a botnet.
5.  **Web Attacks**: e.g., SQL Injection, Cross-Site Scripting (XSS), Brute Force
6.  **Man-in-the-Middle (MitM)**: Intercepting and potentially altering communication.
7.  **Spoofing**: e.g., IP Spoofing, ARP Spoofing
8.  **Brute Force**: e.g., SSH Brute Force, FTP Brute Force
9.  **Malware/Infiltration**: Attacks involving malware designed for IoT devices.

The dataset typically provides fine-grained labels for **33 distinct attack types** in addition to benign traffic.

## Feature Set

The dataset is usually provided in CSV format, with each row representing a network flow and columns representing various features extracted from that flow. Key features often include:

-   Flow Duration
-   Total Forward/Backward Packets
-   Total Forward/Backward Bytes
-   Packet Length Statistics (Min, Max, Mean, Std)
-   Flow IAT Statistics (Mean, Std, Max, Min)
-   Header Lengths
-   Protocol Type
-   Flags (TCP Flags like SYN, ACK, FIN, RST)
-   Port Numbers (Source and Destination)
-   And many more derived features.

In this project, a subset of these features (e.g., 40-50 selected or engineered features) is used for training the LSTM model after preprocessing. The `src/utils/dataset_processor.py` handles the selection, cleaning, and transformation of these features.

## Role in the RL-IoT Defense System

1.  **LSTM Attack Predictor Training**:
    -   The `RealDataLSTMPredictor` (`src/models/lstm_attack_predictor.py`) is trained exclusively on sequences of processed features from the CICIoT2023 dataset.
    -   The goal is to learn patterns indicative of various attack types and predict their occurrence.
    -   The labels from the dataset serve as the ground truth for this supervised learning task.

2.  **RL Environment Realism**:
    -   While the RL environment (`src/environment.py`) is a simulation, its design regarding attack types, their impact, and general network telemetry can be informed by the characteristics observed in CICIoT2023.
    -   The `EnhancedAttackPredictor` uses the LSTM trained on CICIoT2023 to provide realistic attack predictions within the simulated environment, influencing the RL agent's observations and the reward function.

3.  **Preprocessing Artifacts**:
    -   During data processing (`src/utils/dataset_processor.py`), artifacts like scalers (e.g., `StandardScaler`) and label encoders are created based on the CICIoT2023 training split.
    -   These artifacts (`preprocessing_artifacts.pkl`) are crucial for ensuring that input data to the LSTM (both during training and inference via `EnhancedAttackPredictor`) is consistently transformed.

## Data Processing Pipeline

1.  **Acquisition**: Download raw CSV files from the official source.
2.  **Initial Cleaning**: Handle missing values, infinite values, and select relevant raw features.
3.  **Feature Engineering (Optional)**: Create new features if deemed beneficial.
4.  **Feature Scaling**: Normalize/Standardize numerical features (e.g., using `StandardScaler`).
5.  **Label Encoding**: Convert categorical attack labels into numerical format.
6.  **Data Splitting**: Divide the dataset into training, validation, and test sets.
7.  **Sequencing**: For LSTM training, create sequences of data points (e.g., a sliding window over network flows). This is handled by `CICIoTDataLoader`.
8.  **Saving Processed Data & Artifacts**: Store the processed data (e.g., in NumPy arrays or HDF5 files) and preprocessing artifacts (scalers, encoders) for later use.

The `src/utils/dataset_processor.py` and `src/utils/dataset_loader.py` are responsible for these steps.

By using CICIoT2023, the RL-IoT Defense System aims to develop defense mechanisms that are effective against realistic, contemporary